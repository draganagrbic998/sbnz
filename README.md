# Експертски систем за коришћење штедних рачуна

## Чланови тима
- Драгана Грбић SW22/2017
- Петар Николић SW31/2017

## Мотивација
Потреба људи за неким видом штедње све је већи, а то представља савршену прилику банкарским кућама да осмисле различите политике штедње које ће им привући што већи број клијената. Класичан принцип отварања штедног рачуна јесте тај да сама банка дефинише низ табела којe одговарајући период орочења мапирају на одређену каматну стопу и остале параметре. Поставља се питање колико просечна особа може да се снађе у таквом изобиљу понуда. 

Код свих банака које смо гледали принцип је мање више исти - банке дефинишу табеле које корисник мора самостално да анализира како би пронашао колону која му највише одговара, а то може бити веома фрустрирајуће. Било би добро када би сам корисник могао да дефинише колико би новца могао да орочи и на колики период, а да му потом банка одговори да ли је могуће успоставити одговарајући уговор за унете параметре и, уколико јесте, да му представи услове и каматне стопе које би том приликом остварио. Наш циљ биће управо то, имплементација система који ће користити експертско знање из домена банкарских штедних рачуна, како би омогућио фклексибилније отварање штедног рачуна.

## Опис проблема
Циљ је имплементирати систем који ће омогућавати клијентима флексибилније отварање штедних рачуна. Клијентима ће бити омогућено приликом отварања рачуна да сами дефинишу количину новца коју тренутно могу да уложе и период на који планирају да ороче штедњу, а потом ће добити одговор да ли је банка у могућности да им предложи одговарајући уговор и, уколико јесте, представи каматне стопе које ће се користити приликом месечног обрачуна средстава. 

Такође, идеја је у систем укључити и праћење ранијих активности корисника, како би му се омогућиле евентуалне повластице. На пример, када се корисник одлучи на отварање новог штедног рачуна, биће награђен ако је дужи период клијент банке, ако је активно (у скорашње време) користио рачуне итд. На основу тога, систем ће приликом отварања рачуна одредити број поена који може имати утицаја приликом рачунања месечне каматне стопе. Већи број поена значиће вишу каматну стопу.

Додатно, корисницима ће бити пружена могућност доплате средстава на штедним рачунима и продужетак орочења, уколико се покаже да за то услови постоје. Корисницима ће бити омогућено да за сваки рачун пошаљу захтев за неком од наведених акција, али ће банка, пре него што акцију одобри, вршити проверу услова за њено извршавање. На пример биће спречена претерано учестала уплата средстава на један исти штедни рачун или превелико продужење рачуна итд.

## Методологија рада
Апликација познаје три врсте корисника:
- Администратор
- Службеник
- Клијент

Администратору су доступне следеће акције:
- пријава
- промена лозинке
- преглед, пагинација и претрага свих регистрованих корисника (администратора, службеника и клијената)
- регистрација новог службеника
- измена постојећег службеника
- брисање постојећег службеника
- увид у извештај - број активних и  затворених штедних рачуна, број корисника динарских и девизних рачуна, просечан износ главнице, просена дужина орочења, просечна висина доплата новца на рачунима, број продужених орочења

Службенику су доступне следеће акције:
- пријава
- промена лозинке
- преглед, пагинација и претрага свих отворених клијентских налога, односно рачуна (мисли се на главни рачун у банци, не на штедне рачуне, њима има приступ само власник рачуна)
- отварање новог налога у банци
- измена постојећег налога у банци
- брисање налога за које није везан ниједан активан штедни рачун (активан штедни рачун је рачун којем још увек није истекао период орочења)

Клијенту су доступне следеће акције:
- пријава
- промена лозинке
- преглед отвореног налога у банци
- преглед, пагинација и претрага свих отворених штедних рачуна
- **отварање новог штедног рачуна** (умањује износ на главном рачуну за одабрану главницу и подразумева проверу услова, рачунање номиналне и ефективне каматне стопе, броја поена и додатне награде)
- **доплата средстава на штедни рачун** (подразумева проверу услова, умањење износа на главном рачуну за одабрану суму и корекцију главнице и ефективне каматне стопе)
- **продужетак орочења штедног рачуна** (подразумева проверу услова и корекцију ефективне каматне стопе)
- преглед претходно извршених доплата за одабран рачун
- преглед претходних продужења орочења за одабран рачун

Главне акције су оне за које се покреће резонар са одговарајућим правилима и означене су тамним словима. За доплату средстава на штедни рачун улаз представља одабран рачун и износ који жели да се уплати. За продужетак орочења штедног рачуна улаз је одабран рачун и број месеци за који се рачун жели продужити. За обе акције излаз је потврдан уколико је резонар успоставио да су задовољени услови за извршавање акције. У супротном, излаз је одричан одговор, са додатним образложењем. 

За отварање штедног рачуна улаз представља врста рачуна (динарски или девизни), главница (почетни износ на рачуну) и период орочења изражен у броју месеци. Уколико корисник одабере девизни рачун, бира и одговарајућу валуту (еври, амерички долари, швајцарски франци или бринтански фунти). Излаз акције представља одговор које је потврдан уколико је могуће остварити уговор за унету главницу и период орочења, у супротном је одричан и праћен додатним појашњењем. Ако је одговор потрвдан, додатни параметри излаза су: номинална каматна стопа, број остварених поена, ефективна каматна стопа и додатна награда.

Идентификоване класе и зависност између њих приказани су на клас дијаграму. Класа <b>User</b> представља апстракцију све три врсте корисника. Класа <b>Authority</b> служи за регистрацију корисничких улога (у нашем случају то су администратор, службеник и клијент). Класа <b>Account</b> представља налог отворен у банци, односно главни клијентски рачун. Са њега се преузимају средства потребна за отварање штедних рачуна и евентуалне касније доплате. Класа <b>Bill</b> представља апстракцију динарског или девизног рачуна (тип рачуна одређен је пољем type). Класа <b>Transaction</b> представља запис у систему када је извршена одговарајућа доплата новца на штедни рачун. Класа <b>Renewal</b> представља запис у систему када је извршено продужење орочења рачуна.

<div align="center">
  <img src="https://github.com/draganagrbic998/sbnz/blob/main/class.png" alt="drawing"/>
</div>

## База знања
Базу знања система чини три групе правила. То су правила која дефинишу политику отварања штедног рачуна, доплате средстава и продужења орочења штедног рачуна.

### 1. Правила за отварање штедног рачуна
Група правила која дефинишу предуслове отварања штедног рачуна и начине на који се рачунају каматне стопе које ће се користити приликом месечног обрачуна средстава.

#### А. Противуслови отварања штедног рачуна
Правила која дефинишу недозвољене ситуације приликом захтева за отварањем рачуна. Уколико је барем једна од ситуација задовољена, отварање рачуна биће спречено.

##### Отварање штедног рачуна је онемогућено у следећим случајевима:
- Корисник је одабрао динарски рачун са главницом мањом од 10.000 РСД.
- Корисник је одабрао динарски рачун са главницом већом од 10.000.000 РСД.
- Корисник је одабрао динарски рачун са бројем месеци мањим од 4.
- Корисник је одабрао динарски рачун са бројем месеци већим од 42.
- Корисник је одабрао динарски рачун са главницом која када би се скинула са главног рачуна, на њему не би остало барем 200 РСД.
- Корисник је малолетан и одабрао је динарски рачун са главницом већом од 100.000 РСД.
- Корисник је малолетан и одабрао је динарски рачун, а већ поседује 2 активна динарска рачуна.
- Корисник је одабрао девизни рачун са главницом мањом од 100 јединица валуте.
- Корисник је одабрао девизни рачун са главницом већом од 100.000 јединица валуте.
- Корисник је одабрао девизни рачун са бројем месеци мањим од 2.
- Корисник је одабрао девизни рачун са бројем месеци већим од 36.
- Корисник је одабрао девизни рачун са главницом која када би се скинула са главног рачуна, на њему не би остало барем 1.000 РСД.
- Корисник је малолетан и одабрао је девизни рачун са главницом већом од 1.000 јединица валуте.
- Корисник је малолетан и одабрао је девизни рачун, а већ поседује 1 активан девизни рачун.

#### Б. Правила за рачунање номиналне каматне стопе
Номинална каматна стопа служи за рачунање коначне месечне каматне стопе. Рачуна се посебно за сваку валуту и одабране вредности периода орочења и главнице. Приликом резоновања правила, узима се најповољнија каматна стопа.

##### Камата износи 1.5%
- Корисник је одабрао динарски рачун са бројем месеци већим од 21 или главницом која када се подели са бројем месеци износи више од 100.000 РСД.
- Корисник је одабрао девизни рачун у еврима са бројем месеци већим од 30 или главницом која када се подели са бројем месеци износи више од 3.000 еври.
- Корисник је одабрао девизни рачун у америчким доларима са бројем месеци већим од 27 или главницом која када се подели са бројем месеци износи више од 2.900 долара.
- Корисник је одабрао девизни рачун у швајцарским францима са бројем месеци већим од 24 или главницом која када се подели са бројем месеци износи више од 2.800 франака.
- Корисник је одабрао девизни рачун у британским фунтама са бројем месеци већим од 33 или главницом која када се подели са бројем месеци износи више од 3.010 фунти.

##### Камата износи 1.2%
- Корисник је одабрао динарски рачун са бројем месеци већим од 15 или главницом која када се подели са бројем месеци износи више од 50.000 РСД.
- Корисник је одабрао девизни рачун у еврима са бројем месеци већим од 24 или главницом која када се подели са бројем месеци износи више од 2.000 еври.
- Корисник је одабрао девизни рачун у америчким доларима са бројем месеци већим од 21 или главницом која када се подели са бројем месеци износи више од 1.900 долара.
- Корисник је одабрао девизни рачун у швајцарским францима са бројем месеци већим од 18 или главницом која када се подели са бројем месеци износи више од 1.800 франака.
- Корисник је одабрао девизни рачун у британским фунтама са бројем месеци већим од 27 или главницом која када се подели са бројем месеци износи више од 2.100 фунти.

##### Камата износи 1.0%
- Корисник је одабрао динарски рачун са бројем месеци већим од 9 или главницом која када се подели са бројем месеци износи више од 30.000 РСД.
- Корисник је одабрао девизни рачун у еврима са бројем месеци већим од 18 или главницом која када се подели са бројем месеци износи више од 1.000 еври.
- Корисник је одабрао девизни рачун у америчким доларима са бројем месеци већим од 15 или главницом која када се подели са бројем месеци износи више од 900 долара.
- Корисник је одабрао девизни рачун у швајцарским францима са бројем месеци већим од 12 или главницом која када се подели са бројем месеци износи више од 800 франака.
- Корисник је одабрао девизни рачун у британским фунтама са бројем месеци већим од 21 или главницом која када се подели са бројем месеци износи више од 1.100 фунти.

##### Камата износи 0.8%
- Корисник је одабрао динарски рачун са бројем месеци већим од 6 или главницом која када се подели са бројем месеци износи више од 10.000 РСД.
- Корисник је одабрао девизни рачун у еврима са бројем месеци већим од 12 или главницом која када се подели са бројем месеци износи више од 500 еври.
- Корисник је одабрао девизни рачун у америчким доларима са бројем месеци већим од 9 или главницом која када се подели са бројем месеци износи више од 480 долара.
- Корисник је одабрао девизни рачун у швајцарским францима са бројем месеци већим од 6 или главницом која када се подели са бројем месеци износи више од 470 франака.
- Корисник је одабрао девизни рачун у британским фунтама са бројем месеци већим од 15 или главницом која када се подели са бројем месеци износи више од 520 фунти.

##### Камата износи 0.5%
- Корисник је одабрао динарски рачун са бројем месеци не већим од 6 и главницом која када се подели са бројем месеци износи не више од 10.000 РСД.
- Корисник је одабрао девизни рачун у еврима са бројем месеци не већим од 12 и главницом која када се подели са бројем месеци износи не више од 500 еври.
- Корисник је одабрао девизни рачун у америчким доларима са бројем месеци не већим од 9 и главницом која када се подели са бројем месеци износи не више од 480 долара.
- Корисник је одабрао девизни рачун у швајцарским францима са бројем месеци не већим од 6 и главницом која када се подели са бројем месеци износи не више од 470 франака.
- Корисник је одабрао девизни рачун у британским фунтама са бројем месеци не већим од 15 и главницом која када се подели са бројем месеци износи не више од 520 фунти.

#### В. Правила за рачунање бонус поена
Поред номиналне каматне стопе, у систем је укључена и могућност коришћења повластица - повољније камате уколико је корисник високо бодован, односно забележен као квалитетан клијент. Приликом резоновања правила, узима се најпобољнији број поена. За сваку групу правила неопходно је да је **барем два услова задовољено**.

##### 5 поена
- Корисник има отворен рачун у банци барем 5 година.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна са главницом већом од 200.000 РСД.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна са главницом већом од 2001 јединица валуте.
- У последњих 9 месеци просечна вредност главнице на свим динарским рачунима износи барем 100.000 РСД.
- У последњих 12 месеци просечна вредност главнице на свим девизним рачунима износи барем 1.000 јединица валуте.

##### 4 поена
- Корисник има отворен рачун у банци барем 4 године.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна са бројем месеци већим од 12.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна са бројем месеци већим од 9.
- У последњих 9 месеци сума свих главница на свим динарским рачунима износи барем 300.000 РСД.
- У последњих 12 месеци сума свих главница на свим девизним рачунима износи барем 3.000 јединица валуте.

##### 3 поена
- Корисник има отворен рачун у банци барем 3 године.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна на којима је извршено више од 2 уплате са износом од барем 10.000 РСД.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна на којем је извршено више од 1 уплате са износом од барем 100 јединица валуте.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна на којима је сума свих уплата већа од 30% главнице.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна на којем је сума свих уплата већа од 20% главнице.

##### 2 поена
- Корисник има отворен рачун у банци барем 2 године.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна којима је главница већа од 50.000 РСД и просек свих уплата већи од 10.000 РСД.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна којем је главница већа од 500 јединица валуте и просек свих уплата већи од 100 јединица валуте.
- У последњих 9 месеци кориснику је просек свих уплата на свим динарским рачунима барем 50.000 РСД.
- У последњих 12 месеци кориснику је просек свих уплата на свим девизним рачунима барем 500 јединица валуте.

##### 1 поен
- Корисник има отворен рачун у банци барем 1 годину.
- У последњих 9 месеци кориснику је забележено отварање барем 2 динарска рачуна којима је број месеци већи од 6 и сума свих уплата већа од 10.000 РСД.
- У последњих 12 месеци кориснику је забележено отварање барем 1 девизног рачуна којем је број месеци већи од 3 и сума свих уплата већа од 100 јединица валуте.
- У последњих 9 месеци кориснику је сума свих уплата на свим динарским рачунима барем 80.000 РСД.
- У последњих 12 месеци кориснику је сума свих уплата на свим девизним рачунима барем 800 јединица валуте.

#### Г. Правила за рачунање ефективне каматне стопе
Ефективна каматна стопа је коначну каматну стопу која се користи приликом месечног обрачуна средстава и представља проценат номиналне каматне стопе. Код 95% банака које смо гледали, ова каматна стопа је фиксна и износи 85%. У нашем случају то ће вити подразумевана вредност, али ћемо дозволити њено повећање уколико је корисник високо бодован, уз додатну награду у виду одређене суме динара. 
Приликом резоновања, узима се најповољнија каматна стопа. За сваку групу правила довољно је да је један од услова задовољен.

##### Камата износи 100% и корисник добија награду од 5000 динара
- Корисник је бодован са 5 поена.
- Корисник отвара први динарски рачун.
- Корисник отвара први девизни рачун.

##### Камата износи 98% и корисник добија награду од 2000 динара
- Корисник је бодован са 4 поена.
- Корисник отвара први девизни рачун у еврима.
- Корисник отвара први девизни рачун у америчким доларима.

##### Камата износи 95% и корисник добија награду од 1000 динара
- Корисник је бодован са 3 поена.
- Корисник отвара први девизни рачун у швајцарским францима.
- Корисник отвара први девизни рачун у британским фунтама.

##### Камата износи 90% и корисник добија награду од 500 динара
- Корисник је бодован са 2 поена.
- Корисник отвара динарски рачун, а сви претходни су затворени.

##### Камата износи 87% и корисник добија награду од 200 динара
- Корисник је бодован са 1 поеном.
- Корисник отвара девизни рачун, а сви претходни су затворени.

#### Д. Дијаграм повезивања правила за отварање штедног рачуна
Групу правила за отварање штедног рачуна чини четири слоја - слој за откривање недозвољених ситуација, слој за рачунање номиналне каматне стопе, слој за рачунање бонус поена и слој за рачунање ефективне каматне стопе и додатне награде. Правила се повезују редоследом којим су наведени, што се види на слици испод. Наиме, прво се извршавају правила која откривају недозвољене ситуације. Затим, ако се није десила ниједна недозвољена ситуација, позивају се правила за рачунање номиналне каматне стопе. Након тога, позивају се правила за рачунање бонус поена и на крају се рачуна ефективна каматна стопа и додатна награда. Излаз из ова четири слоја представљају израчунате вредности номиналне и ефективне каматне стопе, бонус поена и додатне награде, уколико се није десила нека забрањена ситуација. Уколико се пак десила, одговарајућа порука се приказује кориснику. У супротном, обавештава се о каматним стопама које би његов рачун имао и даје могућност да предложене услове прихати, или пак одбије.

<div align="center">
  <img src="https://github.com/draganagrbic998/sbnz/blob/main/diagram1.png" alt="drawing"/>
</div>

### 2. Правила за доплату средстава на штедни рачун
Група правила која дефинишу предуслове за доплату средстава на штедни рачун, као и начине корекције главнице и ефективне каматне стопе.

#### А. Противуслови доплате средстава
Правила која дефинишу недозвољене ситуације приликом захтева за уплатом средстава. Уколико је барем једна од ситуација задовољена, уплата ће бити спречена.

##### Уплата средстава је онемогућена у следећим случајевима:
- Прошло је мање од 5% периода орочења.
- Прошло је више од 95% периода орочења.
- Корисник је одабрао износ који је мањи од 10% постојећег износа на штедном рачуну.
- Корисник је одабрао износ који је већи 50% постојећег износа на штедном рачуну.
- Корисник је одабрао динарски рачун отворен на мање од 6 месеци.
- Корисник је одабрао динарски рачун са главницом мањом од 75.000 РСД.
- Корисник је одабрао динарски рачун, а већ је извршио 5 уплата на њему.
- Корисник је одабрао девизни рачун отворен на мање од 4 месеца.
- Корисник је одабрао девизни рачун са главницом мањеом од 750 јединица валуте.
- Корисник је одабрао девизни рачун, а већ је извршио 3 уплате на њему.

##### Онемогућена је уплата више од 40% постојећег износа на штедном рачуну уколико:
- Корисник је одабрао динарски рачун са главницом већом од 200.000 РСД.
- Корисник је одабрао динарски рачун и поседује више од 3 активна динарска рачуна.
- Корисник је одабрао динарски рачун и до сада је на одабраном рачуну уплатио више од 50% главнице.
- Корисник је одабрао девизни рачун са главницом већом од 2.000 јединица одабране валуте.
- Корисник је одабрао девизни рачун и поседује више од 2 активнa девизнa рачуна.
- Корисник је одабрао девизни рачун и до сада је на одабраном рачуну уплатио више од 30% главнице.

##### Онемогућена је уплата више од 35% постојећег износа на штедном рачуну уколико:
- Корисник је одабрао динарски рачун са главницом већом од 150.000 РСД.
- Корисник је одабрао динарски рачун и поседује више од 4 активна динарска рачуна.
- Корисник је одабрао динарски рачун и до сада је на одабраном рачуну уплатио више од 60% главнице.
- Корисник је одабрао девизни рачун са главницом већом од 1.500 јединица одабране валуте.
- Корисник је одабрао девизни рачун и поседује више од 3 активна девизна рачуна.
- Корисник је одабрао девизни рачун и до сада је на одабраном рачуну уплатио више од 40% главнице.

##### Онемогућена је уплата више од 30% постојећег износа на штедном рачуну уколико:
- Корисник је одабрао динарски рачун са главницом већом од 100.000 РСД.
- Корисник је одабрао динарски рачун и поседује више од 5 активна динарска рачуна.
- Корисник је одабрао динарски рачун и до сада је на одабраном рачуну уплатио више од 70% главнице.
- Корисник је одабрао девизни рачун са главницом већом од 1.000 јединица одабране валуте.
- Корисник је одабрао девизни рачун и поседује више од 4 активна девизна рачуна.
- Корисник је одабрао девизни рачун и до сада је на одабраном рачуну уплатио више од 50% главнице.

#### Б. Правила за корекцију главнице приликом доплате
Правила која дефинишу начин на који се коригује главница приликом доплате, у зависности од претходног стања рачуна и количине саме уплате. Приликом резоновања правила, узима се најповољнија корекција главнице. За сваку подгрупу правила довољно је да је један од услова задовољен.

##### Главница се увећава за 90% уплате
- Уплата износи више од 40% главнице.
- Стање на динарском рачуну износи више од 300.000 РСД.
- Стање на девизном рачуну износи више од 3.000 јединица одабране валуте.
- Корисник је током последњих 5 месеци на одабраном рачуну уплатио више од 50% главнице.

##### Главница се увећава за 80% уплате
- Уплата износи више од 35% главнице.
- Стање на динарском рачуну износи више од 250.000 РСД.
- Стање на девизном рачуну износи више од 2.500 јединица одабране валуте.
- Корисник је током последњих 6 месеци на одабраном рачуну уплатио више од 45% главнице.

##### Главница се увећава за 70% уплате
- Уплата износи више од 30% главнице.
- Стање на динарском рачуну износи више од 200.000 РСД.
- Стање на девизном рачуну износи више од 2.000 јединица одабране валуте.
- Корисник је током последњих 7 месеци на одабраном рачуну уплатио више од 40% главнице.

##### Главница се увећава за 60% уплате
- Уплата износи више од 20% главнице.
- Стање на динарском рачуну износи више од 150.000 РСД.
- Стање на девизном рачуну износи више од 1.500 јединица одабране валуте.
- Корисник је током последњих 8 месеци на одабраном рачуну уплатио више од 35% главнице.

##### Главница се увећава за 50% уплате
- Уплата износи не више од 20% главнице.
- Стање на динарском рачуну износи не више од 1500.00 РСД.
- Стање на девизном рачуну износи не више од 1.500 јединица одабране валуте.
- Корисник је током последњих 8 месеци на одабраном рачуну уплатио не више од 35% главнице.

#### В. Правила за корекцију ефективне каматне стопе
Правила која дефинишу начин на који се коригује ефективна каматна стопа, у зависности од претходног стања рачуна и количине саме уплате. Приликом резоновања, узима се највеће умањење каматне стопе. За сваку подгрупу правила довољно је да је један од услова задовољен.

##### Камата се умањује за 3%
- Уплата износи више од 35% главнице.
- Стање на динарском рачуну износи више од 330.000 РСД.
- Стање на девизном рачуну износи више од 3.300 јединица одабране валуте.
- Корисник је током последњих 12 месеци на динарским рачунима уплатио у просеку више од 50% износа на главном рачуну.
- Корисник је током последњих 11 месеци на девизним рачунима уплатио у просеку више од 45% износа на главном рачуну.

##### Камата се умањује за 2.5%
- Уплата износи више од 30% главнице.
- Стање на динарском рачуну износи више од 270.000 РСД.
- Стање на девизном рачуну износи више од 2.700 јединица одабране валуте.
- Корисник је током последњих 11 месеци на динарским рачунима уплатио у просеку више од 45% износа на главном рачуну.
- Корисник је током последњих 10 месеци на девизним рачунима уплатио у просеку више од 40% износа на главном рачуну.

##### Камата се умањује за 2%
- Уплата износи више од 25% главнице.
- Стање на динарском рачуну износи више од 220.000 РСД.
- Стање на девизном рачуну износи више од 2.200 јединица одабране валуте.
- Корисник је током последњих 10 месеци на динарским рачунима уплатио у просеку више од 40% износа на главном рачуну.
- Корисник је током последњих 9 месеци на девизним рачунима уплатио у просеку више од 35% износа на главном рачуну.

##### Камата се умањује за 1.5%
- Уплата износи више од 20% главнице.
- Стање на динарском рачуну износи више од 180.000 РСД.
- Стање на девизном рачуну износи више од 1.800 јединица одабране валуте.
- Корисник је током последњих 9 месеци на динарским рачунима уплатио у просеку више од 35% износа на главном рачуну.
- Корисник је током последњих 8 месеци на девизним рачунима уплатио у просеку више од 30% износа на главном рачуну.

##### Камата се умањује за 1%
- Уплата износи не више од 20% главнице.
- Стање на динарском рачуну износи не више од 180.000 РСД.
- Стање на девизном рачуну износи не више од 1.800 јединица одабране валуте.
- Корисник је током последњих 9 месеци на динарским рачунима уплатио у просеку не више од 35% износа на главном рачуну.
- Корисник је током последњих 8 месеци на девизним рачунима уплатио у просеку не више од 30% износа на главном рачуну.

#### Г. Дијаграм повезивања правила за уплату средстава
Групу правила за уплату средстава на штедни рачун чини четири слоја - слој за откривање недозвољених ситуација, слој за обрачун средстава на главном рачуну, слој за корекцију главнице штедног рачуна и слој за корекцију ефективне каматне стопе штедног рачуна. Слојеви се повезују редоследом којим су наведени, што се види на слици испод. Прво се извршавају правила која проверавају да ли се десила нека од недозвољених ситуација. Уколико није, позива се други слој који умањује стање на главном рачуну. Потом се позивају правила за корекцију главнице, а потом правила за корекцију ефективне каматне стопе. На излазу из сва четири слоја налази се рачун са новим вредностима главнице и каматне стопе, уколико се није десила нека забрањена ситуација. Уколико се десила, на излазу ће се наћи одговарајућа порука о грешци, а која ће се приказати кориснику.

<div align="center">
  <img src="https://github.com/draganagrbic998/sbnz/blob/main/diagram3.png" alt="drawing"/>
</div>

### 3. Правила за продужење орочења штедног рачуна
Група правила која дефинишу предуслове за продужење орочења активног рачуна, као и начине корекције каматне стопе приликом одобреног продужења.

#### А. Противуслови продужења орочења
Правила која дефинишу недозвољене ситуације приликом захтева за продужењем орочења. Уколико је бар једна од ситуација задовољена, продужетак ће бити спречен.

##### Продужење орочења је онемогућено у следећим случајевима:
- Корисник је одабрао мање од 3 месеца продужења.
- Корисник је одабрао више од 24 месеца продужења.
- Корисник је одабрао динарску штедњу са минималним периодом орочења од 3 месеца.
- Корисник је одабрао динарску штедњу са периодом орочења од барем 42 месеца.
- Корисник је одабрао девизну штедњу са минималним периодом орочења од 1 месеца.
- Корисник је одабрао девизну штедњу са периодом орочења од барем 36 месеци.
- Корисник је одабрао динарску штедњу са главницом мањом од 75000 РСД.
- Корисник је одабрао девизну штедњу са главницом мањом од 750 јединица одабране валуте.

##### Онемогућено је продужење орочења на више од 18 месеци уколико:
- Корисник је одабрао динарску штедњу са главницом мањом од 250000 РСД.
- Корисник је одабрао девизну штедњу са главницом мањом од 2500 јединица одабране валуте.
- Корисник је одабран рачун већ једном продужио.

##### Онемогућено је продужење орочења на више од 12 месеци уколико:
- Корисник је одабрао динарску штедњу са главницом мањом од 200000 РСД.
- Корисник је одабрао девизну штедњу са главницом мањом од 2000 јединица одабране валуте.
- Корисник је одабран рачун већ 2 пута продужио.

##### Онемогућено је продужење орочења на више од 9 месеци уколико:
- Корисник је одабрао динарску штедњу са главницом мањом од 150000 РСД.
- Корисник је одабрао девизну штедњу са главницом мањом од 1500 јединица одабране валуте.
- Корисник је одабран рачун већ 3 пута продужио.

##### Онемогућено је продужење орочења на више од 6 месеци уколико:
- Корисник је одабрао динарску штедњу са главницом мањом од 100000 РСД.
- Корисник је одабрао девизну штедњу са главницом мањом од 1000 јединица одабране валуте.
- Корисник је одабран рачун већ 5 пута продужио.

#### Б. Правила за корекцију ефективне каматне стопе приликом продужења орочења
Правила која дефинишу начин на који се коригује ефективна каматна стопа приликом одобреног продужења орочења. Приликом резоновања, узима се најповољнија корекција каматне стопе. За сваку подгрупу правила довољно је да је један од услова задовољен. 

##### Камата се увећава за 2.5%
- Орочење је продужено за више од 16 месеци.
- Стање на динарском рачуну износи више од 270000 РСД.
- Стање на девизном рачуну износи више од 2700 јединица одабране валуте.
- Корисник је током последњих 24 месеца продужио динарске рачуне у просеку за више од 15 месеци.
- Корисник је током последњих 21 месеци продужио девизне рачуне у просеку за више од 14 месеци.

##### Камата се увећава за 2%
- Орочење је продужено за више од 13 месеци.
- Стање на динарском рачуну износи више од 220000 РСД.
- Стање на девизном рачуну износи више од 2200 јединица одабране валуте.
- Корисник је током последњих 24 месеца продужио динарске рачуне у просеку за више од 12 месеци.
- Корисник је током последњих 21 месеци продужио девизне рачуне у просеку за више од 11 месеци.

##### Камата се увећава за 1.5%
- Орочење је продужено за више од 9 месеци.
- Стање на динарском рачуну износи више од 170000 РСД.
- Стање на девизном рачуну износи више од 1700 јединица одабране валуте.
- Корисник је током последњих 24 месеца продужио динарске рачуне у просеку за више од 9 месеци.
- Корисник је током последњих 21 месеци продужио девизне рачуне у просеку за више од 8 месеци.

##### Камата се увећава за 1%
- Орочење је продужено за више од 5 месеци.
- Стање на динарском рачуну износи више од 120000 РСД.
- Стање на девизном рачуну износи више од 1200 јединица одабране валуте.
- Корисник је током последњих 24 месеца продужио динарске рачуне у просеку за више од 7 месеци.
- Корисник је током последњих 21 месеци продужио девизне рачуне у просеку за више од 6 месеци.

##### Камата се увећава за 0.5%
- Орочење је продужено за не више од 5 месеци.
- Стање на динарском рачуну износи не више од 120000 РСД.
- Стање на девизном рачуну износи не више од 1200 јединица одабране валуте.
- Корисник је током последњих 24 месеца продужио динарске рачуне у просеку за више од 4 месеца.
- Корисник је током последњих 21 месеци продужио девизне рачуне у просеку за више од 3 месеца.

#### В. Дијаграм повезивања правила за продужење орочења
Групу правила за продужење орочења чини три слоја - слој за откривање недозвољених ситуација, слог који продужава период орочења и слој за корекцију ефективне каматне стопе. Слојеви су повезани радоследом којим су наведени, што се види на слици сипод. Прво се извршавају правила која проверавају да ли се десила недозвољена ситуација. Уколико није, позива се слој који продужава период орочења, а после њега се позивају правила која коригују каматну стопу рачуна. На излази из сва три слоја ће се наћи рачун са новом вредношћу каматне стопе и новим периодом орочења. Уколико се десила нека забрањена ситуација, на излазу ће се наћи порука о грешци, која се потом може приказати кориснику.

<div align="center">
  <img src="https://github.com/draganagrbic998/sbnz/blob/main/diagram4.png" alt="drawing"/>
</div>

